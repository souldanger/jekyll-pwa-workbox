try{self["workbox:window:5.0.0-alpha.0"]&&_()}catch(t){}function t(t,s){return new Promise(i=>{let e=new MessageChannel;e.port1.onmessage=(t=>{i(t.data)}),t.postMessage(s,[e.port2])})}try{self["workbox:core:5.0.0-alpha.1"]&&_()}catch(t){}class s{constructor(){this.promise=new Promise((t,s)=>{this.resolve=t,this.reject=s})}}class i{constructor(){this.t={}}addEventListener(t,s){this.s(t).add(s)}removeEventListener(t,s){this.s(t).delete(s)}dispatchEvent(t){t.target=this;const s=this.s(t.type);for(const i of s)i(t)}s(t){return this.t[t]=this.t[t]||new Set}}function e(t,s){const{href:i}=location;return new URL(t,i).href===new URL(s,i).href}class n{constructor(t,s){this.type=t,Object.assign(this,s)}}const h=200,a=6e4;class r extends i{constructor(t,i={}){super(),this.i={},this.h=0,this.o=new s,this.l=new s,this.g=new s,this.u=0,this.v=(()=>{const t=this.m,s=t.installing;this.h>0||!e(s.scriptURL,this.p)||performance.now()>this.u+a?(this.W=s,t.removeEventListener("updatefound",this.v)):(this._=s,this.o.resolve(s)),++this.h,s.addEventListener("statechange",this.L)}),this.L=(t=>{const s=this.m,i=t.target,{state:e}=i,a=i===this.W,r=a?"external":"",o={sw:i,originalEvent:t};!a&&this.B&&(o.isUpdate=!0),this.dispatchEvent(new n(r+e,o)),"installed"===e?this.C=self.setTimeout(()=>{"installed"===e&&s.waiting===i&&this.dispatchEvent(new n(r+"waiting",o))},h):"activating"===e&&(clearTimeout(this.C),a||this.l.resolve(i))}),this.R=(t=>{const s=this._;s===navigator.serviceWorker.controller&&(this.dispatchEvent(new n("controlling",{sw:s,originalEvent:t,isUpdate:this.B})),this.g.resolve(s))}),this.S=(t=>{const{data:s}=t;this.dispatchEvent(new n("message",{data:s,originalEvent:t}))}),this.p=t,this.i=i}async register({immediate:t=!1}={}){t||"complete"===document.readyState||await new Promise(t=>addEventListener("load",t)),this.B=Boolean(navigator.serviceWorker.controller),this.P=this.U(),this.m=await this.k(),this.P&&(this._=this.P,this.l.resolve(this.P),this.g.resolve(this.P),this.D(this.P),this.P.addEventListener("statechange",this.L,{once:!0}));const s=this.m.waiting;return s&&e(s.scriptURL,this.p)&&(this._=s,Promise.resolve().then(()=>{this.dispatchEvent(new n("waiting",{sw:s,wasWaitingBeforeRegister:!0}))})),this._&&this.o.resolve(this._),this.m.addEventListener("updatefound",this.v),navigator.serviceWorker.addEventListener("controllerchange",this.R,{once:!0}),"BroadcastChannel"in self&&(this.I=new BroadcastChannel("workbox"),this.I.addEventListener("message",this.S)),navigator.serviceWorker.addEventListener("message",this.S),this.m}get active(){return this.l.promise}get controlling(){return this.g.promise}async getSW(){return void 0!==this._?this._:this.o.promise}async messageSW(s){return t(await this.getSW(),s)}U(){const t=navigator.serviceWorker.controller;return t&&e(t.scriptURL,this.p)?t:void 0}async k(){try{const t=await navigator.serviceWorker.register(this.p,this.i);return this.u=performance.now(),t}catch(t){throw t}}D(s){t(s,{type:"WINDOW_READY",meta:"workbox-window"})}}export{r as Workbox,t as messageSW};
//# sourceMappingURL=workbox-window.prod.mjs.map
